"serve"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
google_casual_western_1_star_network <- google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("wait", "hot", "cold",
"service", "experience", "food",
"serve"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_casual_western_1_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_casual_western_1_star_network <- google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("wait", "hot", "cold",
"service", "experience", "food",
"serve"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_casual_western_1_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_casual_western_1_star_network <- google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("wait", "hot", "cold",
"service", "experience", "food",
"serve"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_casual_western_1_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_casual_western_1_star_network <- google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .12) |>
left_join(
google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("wait", "hot", "cold",
"service", "experience", "food",
"serve", "taste", "price"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_casual_western_1_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_casual_western_1_star_network <- google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .12) |>
left_join(
google_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 1) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("wait", "hot", "cold",
"service", "quality", "rude",
"serve", "taste", "price"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_casual_western_1_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
trip_casual_western_5_star_network <- trip_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .18) |>
left_join(
trip_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("wait", "hot", "cold",
"service", "experience", "food",
"serve"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Trip Advisor Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: TripAdvisor; Ng Choon Khon")
ggsave(here("plots", "trip_casual_western_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
trip_casual_western_5_star_network <- trip_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .18) |>
left_join(
trip_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("friendly", "ribs", "steak",
"sausage", "highly"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Trip Advisor Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: TripAdvisor; Ng Choon Khon")
ggsave(here("plots", "trip_casual_western_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
trip_casual_western_5_star_network <- trip_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .18) |>
left_join(
trip_kl_cuisine |>
mutate(review_id = row_number()) |>
filter(cuisine == "Casual Western" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 20) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("friendly", "ribs", "steak",
"sausage", "highly", "beer"),
name,
"")),
size = 3.1,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of One-star Casual Western Restaurant Trip Advisor Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: TripAdvisor; Ng Choon Khon")
ggsave(here("plots", "trip_casual_western_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_rating_bigrams |>
mutate(rating = as.factor(rating)) |>
arrange(desc(n)) |>
group_by(rating) |>
slice(1:15) |>
ungroup() |>
ggplot(aes(x = n, y = reorder_within(bigram, n, rating))) +
geom_col(aes(fill = rating)) +
scale_fill_manual(values = c(
1 = "#e76f51",
google_rating_bigrams |>
mutate(rating = as.factor(rating)) |>
arrange(desc(n)) |>
group_by(rating) |>
slice(1:15) |>
ungroup() |>
ggplot(aes(x = n, y = reorder_within(bigram, n, rating))) +
geom_col(aes(fill = rating)) +
scale_fill_manual(values = c(
1 = "#e76f51",
google_rating_bigrams |>
mutate(rating = as.factor(rating)) |>
arrange(desc(n)) |>
group_by(rating) |>
slice(1:15) |>
ungroup() |>
ggplot(aes(x = n, y = reorder_within(bigram, n, rating))) +
geom_col(aes(fill = rating)) +
scale_fill_manual(values = c(
`1` = "#e76f51",
`2` = "#f4a261",
`3` = "#e9c46a",
`4` = "#2a9d8f",
`5` = "#264653"
)) +
facet_wrap(~ rating, scales = "free") +
scale_y_reordered() +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(x = "Count",
y = "",
title = "Most common bigrams by rating, Google reviews")
trip_rating_bigrams |>
filter(bigram %out% c("kuala lumpur")) |>
mutate(rating = as.factor(rating)) |>
arrange(desc(n)) |>
group_by(rating) |>
slice(1:20) |>
ungroup() |>
ggplot(aes(x = n, y = reorder_within(bigram, n, rating))) +
geom_col(aes(fill = rating)) +
scale_fill_manual(values = c(
`1` = "#e76f51",
`2` = "#f4a261",
`3` = "#e9c46a",
`4` = "#2a9d8f",
`5` = "#264653"
)) +
facet_wrap(~ rating, scales = "free") +
scale_y_reordered() +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(x = "Count",
y = "",
title = "Most common bigrams by rating, Trip Advisor reviews")
trip_rating_bigrams |>
filter(bigram %out% c("kuala lumpur")) |>
mutate(rating = as.factor(rating)) |>
arrange(desc(n)) |>
group_by(rating) |>
slice(1:15) |>
ungroup() |>
ggplot(aes(x = n, y = reorder_within(bigram, n, rating))) +
geom_col(aes(fill = rating)) +
scale_fill_manual(values = c(
`1` = "#e76f51",
`2` = "#f4a261",
`3` = "#e9c46a",
`4` = "#2a9d8f",
`5` = "#264653"
)) +
facet_wrap(~ rating, scales = "free") +
scale_y_reordered() +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(x = "Count",
y = "",
title = "Most common bigrams by rating, Trip Advisor reviews")
