plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("waited", "service", "experience",
"price", "quality", "fresh",
"tasted", "disappointing"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
clean_common_foods <- function(tbl){
tbl |>
mutate(review = str_replace_all(review, "Dim sum|Dim Sum|dim sum", "dimsum"),
review = str_replace_all(review, "Tom Yam|Tom Yum|Tom yam|Tom yum|tom yam|tom yum", "tomyum"),
review = str_replace_all(review, "Char Siew|Char siew|char siew", "charsiew"),
review = str_replace_all(review, "Hokkien mee|Hokkien Mee|hokkien mee", "hokkienmee"),
review = str_replace_all(review, "Roast Duck|Roast duck|roast duck", "roastduck"),
review = str_replace_all(review, "Fried Rice|Fried rice|fried rice", "friedrice"),
review = str_replace_all(review, "Roast pork|roast pork|Roast Pork", "roastpork"),
review = str_replace_all(review, "Mee hoon|mee hoon|Bee hoon|bee hoon|Mee Hoon|Bee Hoon", "beehoon"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "Siew yoke|siew yoke|siu yuk|Siu Yuk", "siewyoke"),
review = str_replace_all(review, "chee cheong fun|Chee cheong fun", "cheecheongfun"),
review = str_replace_all(review, "Kaya toast|kaya toast", "kaya toast"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "Salted egg|salted egg", "saltedegg"),
review = str_replace_all(review, "Xiao long bao|xiao long bao|Xiao Long Bao", "xiaolongbao"),
review = str_replace_all(review, "Chicken rice|chicken rice|Chicken Rice", "chickenrice"),
review = str_replace_all(review, "Foreign workers|foreign workers", "foreignworkers"))
}
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("waited", "service", "experience",
"price", "quality", "fresh",
"tasted", "disappointing"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
clean_common_foods <- function(tbl){
tbl |>
mutate(review = str_replace_all(review, "Dim sum|Dim Sum|dim sum", "dimsum"),
review = str_replace_all(review, "Tom Yam|Tom Yum|Tom yam|Tom yum|tom yam|tom yum", "tomyum"),
review = str_replace_all(review, "Char Siew|Char siew|char siew", "charsiew"),
review = str_replace_all(review, "Hokkien mee|Hokkien Mee|hokkien mee", "hokkienmee"),
review = str_replace_all(review, "Roast Duck|Roast duck|roast duck", "roastduck"),
review = str_replace_all(review, "Fried Rice|Fried rice|fried rice", "friedrice"),
review = str_replace_all(review, "Roast pork|roast pork|Roast Pork", "roastpork"),
review = str_replace_all(review, "Mee hoon|mee hoon|Bee hoon|bee hoon|Mee Hoon|Bee Hoon", "beehoon"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "char kuey teow|Char kuey teow|char koay teow", "charkueyteow"),
review = str_replace_all(review, "Hong Kong|hong kong", "hongkong"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "Siew yoke|siew yoke|siu yuk|Siu Yuk", "siewyoke"),
review = str_replace_all(review, "chee cheong fun|Chee cheong fun", "cheecheongfun"),
review = str_replace_all(review, "Kaya toast|kaya toast", "kaya toast"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "Salted egg|salted egg", "saltedegg"),
review = str_replace_all(review, "Xiao long bao|xiao long bao|Xiao Long Bao", "xiaolongbao"),
review = str_replace_all(review, "Chicken rice|chicken rice|Chicken Rice", "chickenrice"),
review = str_replace_all(review, "Foreign workers|foreign workers", "foreignworkers"))
}
clean_common_foods <- function(tbl){
tbl |>
mutate(review = str_replace_all(review, "Dim sum|Dim Sum|dim sum", "dimsum"),
review = str_replace_all(review, "Tom Yam|Tom Yum|Tom yam|Tom yum|tom yam|tom yum", "tomyum"),
review = str_replace_all(review, "Char Siew|Char siew|char siew", "charsiew"),
review = str_replace_all(review, "Hokkien mee|Hokkien Mee|hokkien mee", "hokkienmee"),
review = str_replace_all(review, "Roast Duck|Roast duck|roast duck", "roastduck"),
review = str_replace_all(review, "Fried Rice|Fried rice|fried rice", "friedrice"),
review = str_replace_all(review, "Roast pork|roast pork|Roast Pork", "roastpork"),
review = str_replace_all(review, "Mee hoon|mee hoon|Bee hoon|bee hoon|Mee Hoon|Bee Hoon", "beehoon"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "char kuey teow|Char kuey teow|char koay teow", "charkueyteow"),
review = str_replace_all(review, "Hong Kong|hong kong", "hongkong"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "Siew yoke|siew yoke|siu yuk|Siu Yuk", "siewyoke"),
review = str_replace_all(review, "chee cheong fun|Chee cheong fun", "cheecheongfun"),
review = str_replace_all(review, "Kaya toast|kaya toast", "kaya toast"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "Salted egg|salted egg", "saltedegg"),
review = str_replace_all(review, "Xiao long bao|xiao long bao|Xiao Long Bao", "xiaolongbao"),
review = str_replace_all(review, "Chicken rice|chicken rice|Chicken Rice", "chickenrice"),
review = str_replace_all(review, "Foreign workers|foreign workers", "foreignworkers"))
}
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("peak", "service", "experience",
"price", "pork", "fresh",
"tasted", "recommended", "friendly"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("peak", "service", "experience",
"price", "pork", "fresh",
"tasted", "recommended", "friendly", "crispy"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
clean_common_foods <- function(tbl){
tbl |>
mutate(review = str_replace_all(review, "Dim sum|Dim Sum|dim sum", "dimsum"),
review = str_replace_all(review, "Tom Yam|Tom Yum|Tom yam|Tom yum|tom yam|tom yum", "tomyum"),
review = str_replace_all(review, "Char Siew|Char siew|char siew", "charsiew"),
review = str_replace_all(review, "Hokkien mee|Hokkien Mee|hokkien mee", "hokkienmee"),
review = str_replace_all(review, "Roast Duck|Roast duck|roast duck", "roastduck"),
review = str_replace_all(review, "Fried Rice|Fried rice|fried rice", "friedrice"),
review = str_replace_all(review, "Roast pork|roast pork|Roast Pork", "roastpork"),
review = str_replace_all(review, "Mee hoon|mee hoon|Bee hoon|bee hoon|Mee Hoon|Bee Hoon", "beehoon"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "char kuey teow|Char kuey teow|char koay teow", "charkueyteow"),
review = str_replace_all(review, "Hong Kong|hong kong", "hongkong"),
review = str_replace_all(review, "Siew yoke|siew yoke|siu yuk|Siu Yuk", "siewyoke"),
review = str_replace_all(review, "chee cheong fun|Chee cheong fun", "cheecheongfun"),
review = str_replace_all(review, "Kaya toast|kaya toast", "kaya toast"),
review = str_replace_all(review, "Din Tai Fung|din tai fung", "dintaifung"),
review = str_replace_all(review, "Salted egg|salted egg", "saltedegg"),
review = str_replace_all(review, "Xiao long bao|xiao long bao|Xiao Long Bao", "xiaolongbao"),
review = str_replace_all(review, "Chicken rice|chicken rice|Chicken Rice", "chickenrice"),
review = str_replace_all(review, "Foreign workers|foreign workers", "foreignworkers"))
}
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("peak", "service", "experience",
"price", "pork", "fresh",
"tasted", "recommended", "friendly", "crispy"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
clean_common_foods <- function(tbl){
tbl |>
mutate(review = str_replace_all(review, "Dim sum|Dim Sum|dim sum", "dimsum"),
review = str_replace_all(review, "Tom Yam|Tom Yum|Tom yam|Tom yum|tom yam|tom yum", "tomyum"),
review = str_replace_all(review, "Char Siew|Char siew|char siew", "charsiew"),
review = str_replace_all(review, "Hokkien mee|Hokkien Mee|hokkien mee", "hokkienmee"),
review = str_replace_all(review, "Roast Duck|Roast duck|roast duck", "roastduck"),
review = str_replace_all(review, "Fried Rice|Fried rice|fried rice", "friedrice"),
review = str_replace_all(review, "Roast pork|roast pork|Roast Pork", "roastpork"),
review = str_replace_all(review, "Mee hoon|mee hoon|Bee hoon|bee hoon|Mee Hoon|Bee Hoon", "beehoon"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "char kuey teow|Char kuey teow|char koay teow", "charkueyteow"),
review = str_replace_all(review, "Hong Kong|hong kong", "hongkong"),
review = str_replace_all(review, "Siew yoke|siew yoke|siu yuk|Siu Yuk", "siewyoke"),
review = str_replace_all(review, "chee cheong fun|Chee cheong fun", "cheecheongfun"),
review = str_replace_all(review, "Kaya toast|kaya toast", "kaya toast"),
review = str_replace_all(review, "Din Tai Fung|din tai fung", "dintaifung"),
review = str_replace_all(review, "Salted egg|salted egg", "saltedegg"),
review = str_replace_all(review, "Kuala Lumpur|kuala lumpur|Kuala lumpur", "kl"),
review = str_replace_all(review, "Xiao long bao|xiao long bao|Xiao Long Bao", "xiaolongbao"),
review = str_replace_all(review, "Chicken rice|chicken rice|Chicken Rice", "chickenrice"),
review = str_replace_all(review, "Foreign workers|foreign workers", "foreignworkers"))
}
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("peak", "service", "experience",
"price", "pork", "fresh",
"tasted", "recommended", "friendly", "crispy"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
clean_common_foods <- function(tbl){
tbl |>
mutate(review = str_replace_all(review, "Dim sum|Dim Sum|dim sum", "dimsum"),
review = str_replace_all(review, "Tom Yam|Tom Yum|Tom yam|Tom yum|tom yam|tom yum", "tomyum"),
review = str_replace_all(review, "Char Siew|Char siew|char siew", "charsiew"),
review = str_replace_all(review, "Hokkien mee|Hokkien Mee|hokkien mee", "hokkienmee"),
review = str_replace_all(review, "Roast Duck|Roast duck|roast duck", "roastduck"),
review = str_replace_all(review, "Fried Rice|Fried rice|fried rice", "friedrice"),
review = str_replace_all(review, "Roast pork|roast pork|Roast Pork", "roastpork"),
review = str_replace_all(review, "Mee hoon|mee hoon|Bee hoon|bee hoon|Mee Hoon|Bee Hoon", "beehoon"),
review = str_replace_all(review, "Bak kut teh|bak kut teh|Bak Kut Teh", "bakkutteh"),
review = str_replace_all(review, "char kuey teow|Char kuey teow|char koay teow|Char Kuey Teow", "charkueyteow"),
review = str_replace_all(review, "Hong Kong|hong kong", "hongkong"),
review = str_replace_all(review, "Siew yoke|siew yoke|siu yuk|Siu Yuk", "siewyoke"),
review = str_replace_all(review, "chee cheong fun|Chee cheong fun", "cheecheongfun"),
review = str_replace_all(review, "Kaya toast|kaya toast", "kaya toast"),
review = str_replace_all(review, "Din Tai Fung|din tai fung", "dintaifung"),
review = str_replace_all(review, "Salted egg|salted egg", "saltedegg"),
review = str_replace_all(review, "Kuala Lumpur|kuala lumpur|Kuala lumpur", "kl"),
review = str_replace_all(review, "Xiao long bao|xiao long bao|Xiao Long Bao", "xiaolongbao"),
review = str_replace_all(review, "Chicken rice|chicken rice|Chicken Rice", "chickenrice"),
review = str_replace_all(review, "Foreign workers|foreign workers", "foreignworkers"))
}
google_chinese_5_star_network <- google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_cor(word, review_id, sort = TRUE) |>
filter(correlation >= .15) |>
left_join(
google_kl_cuisine |>
clean_common_foods() |>
mutate(review_id = row_number()) |>
filter(cuisine == "Chinese" & rating == 5) |>
unnest_tokens(word, review) |>
anti_join(stop_words) |>
filter(str_detect(word, "[a-z]")) |>
add_count(word) |>
filter(n > 15) |>
pairwise_count(word, review_id, sort = TRUE),
by = c("item1", "item2")
) |>
igraph::graph_from_data_frame() |>
ggraph(layout = "fr") +
geom_edge_link(aes(alpha = correlation, edge_width = n), colour = "#457b9d", check_overlap = TRUE) +
scale_edge_width_continuous(range = c(.1, 4), trans = "log10") +
scale_alpha_continuous(range = c(0.01, 0.08)) +
geom_node_point(colour = "#457b9d", alpha = 0.2, size = .5) +
geom_node_text(aes(label = ifelse(name %in%
c("peak", "service", "experience",
"price", "pork", "fresh", "fish",
"tasted", "recommended", "friendly", "crispy"),
str_to_title(name),
"")),
size = 3.5,
alpha = .9,
colour = "#00afb9",
fontface = "bold") +
geom_node_text(aes(label = name), size = 3.1, alpha = .4,
colour = "#caf0f8") +
theme(legend.position = "none",
plot.caption = element_text(hjust = .5, colour = "#219ebc"),
panel.background = element_rect(fill = "#03071e"),
plot.background = element_rect(fill = "#1b263b"),
plot.title = element_text(colour = "#219ebc"),
plot.subtitle = element_text(colour = "#219ebc", size = 10)) +
labs(title = "Network graph of Five-star Chinese Restaurant Google Review Descriptions",
subtitle = "Line thickness indicates number of events involving those words, line transparency indicates the correlation between words. Key topics highlighted.",
caption = "Source: maps.google.com; Ng Choon Khon")
ggsave(here("plots", "google_chinese_5_star_network_graph.png"),
width = 10, height = 6.5, units = "in", dpi = 300)
