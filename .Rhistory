y = reorder_within(str_sub(word, 1, 25),
tf_idf,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
filter(n >= 20) |>
arrange(desc(log_odds_weighted)) |>
group_by(rating) |>
slice(1:20) |>
ggplot(aes(x = log_odds_weighted,
y = reorder_within(str_sub(word, 1, 25),
log_odds_weighted,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(log_odds_weighted)) |>
slice(1:20) |>
ggplot(aes(x = log_odds_weighted,
y = reorder_within(str_sub(word, 1, 25),
log_odds_weighted,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n)
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = log_odds_weighted,
y = reorder_within(str_sub(word, 1, 25),
log_odds_weighted,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = log_odds_weighted,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n))
google_rating_words
google_rating_words |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20)
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
distinct(rating, word, n)
google_rating_words |>
arrange(desc(n))
google_rating_words <- google_kl_cuisine |>
select(rowid, rating, review) |>
unnest_tokens(word, review) |>
# mutate(word = SnowballC::wordStem(word, language = "porter")) |>
anti_join(stop_words, by = "word") |>
add_count(word, rating)
google_rating_words
google_rating_words <- google_kl_cuisine |>
select(rowid, rating, review) |>
unnest_tokens(word, review) |>
# mutate(word = SnowballC::wordStem(word, language = "porter")) |>
anti_join(stop_words, by = "word") |>
add_count(word, rating)
trip_rating_words <- trip_kl_cuisine |>
select(rowid, review, rating) |>
unnest_tokens(word, review) |>
# mutate(word = SnowballC::wordStem(word, language = "porter")) |>
anti_join(stop_words, by = "word") |>
add_count(word, rating)
google_rating_words |>
bind_tf_idf(word, rating, n) |>
tidylo::bind_log_odds(word, rating, n) |>
distinct(rating, word, n, tf, idf, tf_idf, log_odds_weighted) |>
# This is not helpful since you'll always get a bunch of cuisines
filter(n > 150) |>
group_by(rating) |>
arrange(desc(tf_idf)) |>
slice_head(n = 15)
distinct(rating, word, n) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "chicken", "time")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "chicken", "time", "kl")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "chicken", "time", "kl", "price")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free")
google_rating_words |>
glimpse()
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "chicken", "time", "kl", "price")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating),
fill = factor(rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free") +
labs(title = "Most common words in Google review, by rating",
subtitle = 'Excludes = "food", "service", "restaurant", "taste", "chicken", "time", "kl", "price".')
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "chicken", "time", "kl", "price")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating),
fill = factor(rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free") +
labs(title = "Most common words in Google review, by rating",
subtitle = 'Excludes = "food", "service", "restaurant", "taste", "chicken", "time", "kl", "price".'
) +
guides(fill = "none")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "time", "kl", "price")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating),
fill = factor(rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free") +
labs(title = "Most common words in Google review, by rating",
subtitle = 'Excludes "food", "service", "restaurant", "taste", "chicken", "time", "kl", "price".'
) +
guides(fill = "none")
google_rating_words |>
distinct(rating, word, n) |>
filter(n >= 20 & word %out% c(
"food", "service", "restaurant", "taste", "kl", "price")
) |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(word, 1, 25),
n,
rating),
fill = factor(rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free") +
labs(title = "Most common words in Google review, by rating",
subtitle = 'Excludes "food", "service", "restaurant", "taste", "time", "kl", "price".'
) +
guides(fill = "none")
google_rating_bigrams |> glimpse()
google_rating_bigrams |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(bigram, 1, 25),
n,
rating),
fill = factor(rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free") +
labs(title = "Most common bigrams in Google review, by rating",
subtitle = 'Excludes "food", "service", "restaurant", "taste", "time", "kl", "price".'
) +
guides(fill = "none")
google_rating_bigrams |>
group_by(rating) |>
arrange(desc(n)) |>
slice(1:20) |>
ggplot(aes(x = n,
y = reorder_within(str_sub(bigram, 1, 25),
n,
rating),
fill = factor(rating))) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ rating, scales = "free") +
labs(title = "Most common bigrams in Google review, by rating",
subtitle = 'Being friendly counts for a lot.'
) +
guides(fill = "none")
google_ratings_topics |>
(filter(word %out% c
("food"
)
)
) |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_ratings_topics
google_ratings_topics <- tidy(google_words_lda, matrix = "beta")
google_words_dtm <- google_rating_words |>
cast_dtm(rating, word, n)
google_words_lda <- LDA(google_words_dtm, k = 2, control = list(seed = 133))
google_ratings_topics <- tidy(google_words_lda, matrix = "beta")
google_ratings_topics |>
(filter(word %out% c
("food"
)
)
) |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_ratings_topics
google_ratings_topics |>
(filter(term %out% c
("food"
)
)
) |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_ratings_topics
google_words_dtm <- google_rating_words |>
filter(word %out% c("food")) |>
cast_dtm(rating, word, n)
google_words_lda <- LDA(google_words_dtm, k = 2, control = list(seed = 133))
google_ratings_topics |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
oogle_rating_words |>
filter(word %out% c("food"))
google_rating_words
google_rating_words |>
filter(word %out% c("food"))
google_words_dtm <- google_rating_words |>
filter(word %out% c("food")) |>
cast_dtm(rating, word, n)
google_words_lda <- LDA(google_words_dtm, k = 2, control = list(seed = 133))
google_ratings_topics <- tidy(google_words_lda, matrix = "beta")
google_ratings_topics |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_words_dtm <- google_rating_words |>
cast_dtm(rating, word, n)
google_words_lda <- LDA(google_words_dtm, k = 2, control = list(seed = 133))
google_ratings_topics |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_ratings_topics |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_ratings_topics <- tidy(google_words_lda, matrix = "beta")
google_ratings_topics |>
group_by(topic) |>
slice_max(beta, n = 15) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
google_ratings_topics |>
group_by(topic) |>
slice_max(beta, n = 20) |>
ungroup() |>
arrange(topic, -beta) |>
ggplot(aes(x = beta, y = reorder_within(term, beta, topic), fill = topic)) +
geom_col() +
facet_wrap(~ topic, scales = "free") +
scale_y_reordered()
trip_rating_bigrams |>
filter(bigram %out% c("kuala lumpur")) |>
mutate(rating = as.factor(rating)) |>
arrange(desc(n)) |>
group_by(rating) |>
slice(1:20) |>
ungroup() |>
ggplot(aes(x = n, y = reorder_within(bigram, n, rating))) +
geom_col(aes(fill = rating)) +
facet_wrap(~ rating, scales = "free") +
scale_y_reordered() +
guides(fill = "none") +
theme(strip.background = element_rect(fill = "black")) +
labs(x = "Count",
y = "",
title = "Most common bigrams by rating, Trip Advisor reviews")
google_rating_bigrams <- google_kl_cuisine |>
select(rowid, rating, review, cuisine) |>
unnest_tokens(bigram, review, token = "ngrams", n = 2) |>
filter(!is.na(bigram)) |>
add_count(bigram) |>
separate(bigram, c("word1", "word2"), sep = " ") |>
filter(!word1 %in% stop_words$word) |>
filter(!word2 %in% stop_words$word) |>
count(word1, word2, rating, sort = TRUE) |>
unite(bigram, word1, word2, sep = " ") |>
bind_tf_idf(bigram, rating, n)
trip_rating_bigrams <- trip_kl_cuisine |>
select(rowid, rating, review, cuisine) |>
unnest_tokens(bigram, review, token = "ngrams", n = 2) |>
filter(!is.na(bigram)) |>
add_count(bigram) |>
separate(bigram, c("word1", "word2"), sep = " ") |>
filter(!word1 %in% stop_words$word) |>
filter(!word2 %in% stop_words$word) |>
count(word1, word2, rating, sort = TRUE) |>
unite(bigram, word1, word2, sep = " ") |>
bind_tf_idf(bigram, rating, n)
