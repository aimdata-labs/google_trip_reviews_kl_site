"0","google_chinese_5_star_network <- google_kl_cuisine |> "
"0","  clean_common_foods() |>  "
"0","  mutate(review_id = row_number()) |> "
"0","  filter(cuisine == ""Chinese"" & rating == 5) |> "
"0","  unnest_tokens(word, review) |> "
"0","  anti_join(stop_words) |> "
"0","  filter(str_detect(word, ""[a-z]"")) |> "
"0","  add_count(word) |> "
"0","  filter(n > 20) |> "
"0","  pairwise_cor(word, review_id, sort = TRUE) |> "
"0","  filter(correlation >= .15) |> "
"0","  left_join("
"0","    google_kl_cuisine |> "
"0","      clean_common_foods() |> "
"0","      mutate(review_id = row_number()) |> "
"0","      filter(cuisine == ""Chinese"" & rating == 5) |> "
"0","      unnest_tokens(word, review) |> "
"0","      anti_join(stop_words) |> "
"0","      filter(str_detect(word, ""[a-z]"")) |> "
"0","      add_count(word) |> "
"0","      filter(n > 20) |> "
"0","      pairwise_count(word, review_id, sort = TRUE), "
"0","    by = c(""item1"", ""item2"")"
"0","  ) |> "
"0","  igraph::graph_from_data_frame() |> "
"0","  ggraph(layout = ""fr"") + "
"0","  geom_edge_link(aes(alpha = correlation, edge_width = n), colour = ""#457b9d"", check_overlap = TRUE) +"
"0","  scale_edge_width_continuous(range = c(.1, 4), trans = ""log10"") +"
"0","  scale_alpha_continuous(range = c(0.01, 0.08)) +"
"0","  geom_node_point(colour = ""#457b9d"", alpha = 0.2, size = .5) +"
"0","  geom_node_text(aes(label = ifelse(name %in% "
"0","                                        c(""peak"", ""service"", ""experience"", "
"0","                                          ""price"", ""pork"", ""fresh"", ""fish"","
"0","                                          ""tasted"", ""recommended"", ""friendly"", ""crispy""),"
"0","                                      str_to_title(name),"
"0","                                      """")), "
"0","                 size = 3.2, "
"0","                 alpha = .9, "
"0","                 colour = ""#00afb9"", "
"0","                 fontface = ""bold"") +"
"0","  geom_node_text(aes(label = name), size = 3.1, alpha = .4, "
"0","                 colour = ""#caf0f8"") + "
"0","  theme(legend.position = ""none"", "
"0","        plot.caption = element_text(hjust = .5, colour = ""#219ebc""), "
"0","        panel.background = element_rect(fill = ""#03071e""), "
"0","        plot.background = element_rect(fill = ""#1b263b""), "
"0","        plot.title = element_text(colour = ""#219ebc""), "
"0","        plot.subtitle = element_text(colour = ""#219ebc"", size = 10)) + "
"0","  labs(title = ""Network graph of Five-star Chinese Restaurant Google Review Descriptions"", "
"0","       subtitle = ""Line thickness indicates number of reviews involving those words, line transparency indicates the correlation between words. Key topics highlighted."", "
"0","       caption = ""Source: maps.google.com; Ng Choon Khon"")"
"0",""
"0","ggsave(here(""plots"", ""google_chinese_5_star_network_graph.png""), "
"0","       width = 10, height = 6.5, units = ""in"", dpi = 300)"
